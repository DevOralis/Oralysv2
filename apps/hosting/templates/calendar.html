{% extends 'base.html' %}
{% load static %}
{% block title %}Oralys - Planning des Réservations{% endblock %}
{% block menu %}
  {% include 'hosting_menu.html' %}
{% endblock %}

{% block content %}
  <div class="content" >
    <div class="card mb-4">
      <div class="card-header text-white" style="background-color: #1e90ff;">
        <i class="fas fa-calendar-alt me-2"></i>
        Planning des Réservations
      </div>
      <div class="card-body">
        <!-- Légende -->
        <div class="legend">
          <div class="legend-item">
            <div class="legend-color bg-success"></div>
            <span>Réservation confirmée</span>
          </div>
          <div class="legend-item">
            <div class="legend-color bg-info"></div>
            <span>Réservation en attente</span>
          </div>
          <div class="legend-item">
            <div class="legend-color bg-danger"></div>
            <span>Réservation annulée</span>
          </div>
          <div class="legend-item">
            <div class="legend-color bg-warning"></div>
            <span>Aujourd'hui</span>
          </div>
        </div>
        
        <div class="calendar-container">
          <div id="calendar"></div>
        </div>
      </div>
    </div>

    <!-- Liste des réservations -->
    <div class="card mb-4">
      <div class="card-header text-white" style="background-color: #1e90ff;">
        <i class="fas fa-history me-2"></i>
        Liste des Réservations
      </div>
      <div class="card-body">
        <!-- Search Bar Component -->
        <form method="get" id="history-search-form">
          <div class="row g-2 mb-3">
            <!-- Barre de recherche -->
            <div class="col-12 col-sm-12 col-md-5 col-lg-5 order-1">
              <div class="input-group">
                <span class="input-group-text text-white border-primary" style="background-color: #1e90ff;">
                  <i class="fas fa-search"></i>
                </span>
                <input type="search" id="searchReservationHistory" name="q" class="form-control border-primary" placeholder="Rechercher une réservation..." value="">
              </div>
            </div>
            <!-- Filtre statut -->
            <div class="col-8 col-sm-8 col-md-3 col-lg-3 order-2">
              <select class="form-select" id="historyStatusFilter" name="reservation_status" title="Filtrer par statut">
                <option value="">Tous les statuts</option>
                {% for status in reservation_statuses %}
                  <option value="{{ status.0 }}" {% if selected_status == status.0 %}selected{% endif %}>{{ status.1 }}</option>
                {% endfor %}
              </select>
            </div>
            <!-- Boutons d'action -->
            <div class="col-4 col-sm-4 col-md-4 col-lg-4 order-3">
              <div class="d-flex gap-1">
                <button type="button" class="btn btn-light border w-100 text-nowrap px-2" id="export-import-btn">
                  <i class="fas fa-file-import" id="export-import-icon"></i>
                  <span class="d-none d-lg-inline ms-1" id="export-import-text">Importer</span>
                </button>
                <button type="button" class="btn btn-primary w-100 text-nowrap px-2" data-bs-toggle="collapse" data-bs-target="#newReservationForm">
                  <i class="fas fa-plus"></i>
                  <span class="d-none d-lg-inline ms-1">Nouveau</span>
                </button>
              </div>
            </div>
          </div>
        </form>
        <div class="table-responsive">
          <table class="table table-striped table-hover" id="reservationHistoryTable">
            <thead class="table-light borderless">
              <tr class="main-row">
                <th class="d-none d-md-table-cell">
                  <input type="checkbox" id="selectAllHistory">
                </th>
                <th class="sortable" data-sortable="1" style="cursor: pointer;">
                  <div class="d-flex align-items-center justify-content-between">
                    <span>Patient</span>
                    <i class="fas fa-sort sort-icon text-muted"></i>
                  </div>
                </th>
                <th class="d-none d-md-table-cell sortable" data-sortable="2" style="cursor: pointer;">
                  <div class="d-flex align-items-center justify-content-between">
                    <span>Chambre</span>
                    <i class="fas fa-sort sort-icon text-muted"></i>
                  </div>
                </th>
                <th class="d-none d-lg-table-cell sortable" data-sortable="3" style="cursor: pointer;">
                  <div class="d-flex align-items-center justify-content-between">
                    <span>Lit</span>
                    <i class="fas fa-sort sort-icon text-muted"></i>
                  </div>
                </th>
                <th class="d-none d-lg-table-cell sortable" data-sortable="4" style="cursor: pointer;">
                  <div class="d-flex align-items-center justify-content-between">
                    <span>Date de début</span>
                    <i class="fas fa-sort sort-icon text-muted"></i>
                  </div>
                </th>
                <th class="d-none d-lg-table-cell sortable" data-sortable="5" style="cursor: pointer;">
                  <div class="d-flex align-items-center justify-content-between">
                    <span>Date de fin</span>
                    <i class="fas fa-sort sort-icon text-muted"></i>
                  </div>
                </th>
                <th class="d-none d-lg-table-cell sortable" data-sortable="6" style="cursor: pointer;">
                  <div class="d-flex align-items-center justify-content-between">
                    <span>Statut</span>
                    <i class="fas fa-sort sort-icon text-muted"></i>
                  </div>
                </th>
                <th class="text-center">Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for reservation in reservations %}
                <tr>
                  <td data-label="Sélection" class="d-none d-md-table-cell">
                    <input type="checkbox" class="row-check">
                  </td>
                  <td data-label="Patient">{{ reservation.patient }}</td>
                  <td data-label="Chambre" class="d-none d-md-table-cell">{{ reservation.room.room_name }}</td>
                  <td data-label="Lit" class="d-none d-lg-table-cell">{{ reservation.bed.bed_number|default:"Non assigné" }}</td>
                  <td data-label="Date de début" class="d-none d-lg-table-cell">{{ reservation.start_date|date:"d/m/Y" }}</td>
                  <td data-label="Date de fin" class="d-none d-lg-table-cell">{{ reservation.end_date|date:"d/m/Y" }}</td>
                  <td data-label="Statut" class="d-none d-lg-table-cell">
                    <span class="badge {% if reservation.reservation_status == 'confirmed' %}bg-success{% elif reservation.reservation_status == 'pending' %}bg-info{% else %}bg-danger{% endif %}">
                      {{ reservation.get_reservation_status_display }}
                    </span>
                  </td>
                  <td data-label="Actions" class="actions-cell">
                    <div class="d-flex gap-1 justify-content-end">

                      <button class="btn btn-sm btn-light border text-info viewReservationDetails" data-id="{{ reservation.reservation_id }}" title="Voir détails">
                        <i class="fas fa-eye"></i>
                      </button>

                    </div>
                  </td>
                </tr>
              {% empty %}
                <tr>
                  <td colspan="8" class="text-center py-3">Aucune réservation enregistrée</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        <!-- Pagination Component -->
        <nav class="mt-3">
          <ul class="pagination justify-content-center flex-wrap" id="reservationHistoryPagination">
            <li class="page-item disabled">
              <a class="page-link" href="#" aria-label="Précédent" id="prevPageHistory">
                <i class="fas fa-chevron-left d-block d-sm-none"></i>
                <span class="d-none d-sm-block">&laquo; Préc</span>
              </a>
            </li>
            <li class="page-item active">
              <a class="page-link" href="#">1</a>
            </li>
            <li class="page-item">
              <a class="page-link" href="#">2</a>
            </li>
            <li class="page-item d-none d-sm-block">
              <a class="page-link" href="#">3</a>
            </li>
            <li class="page-item">
              <a class="page-link" href="#" aria-label="Suivant" id="nextPageHistory">
                <i class="fas fa-chevron-right d-block d-sm-none"></i>
                <span class="d-none d-sm-block">Suiv &raquo;</span>
              </a>
            </li>
          </ul>
        </nav>
      </div>


    <!-- Formulaire pour nouvelle réservation -->
    <div class="collapse mt-4" id="newReservationForm">
      <div class="card mb-4">
        <div class="card-header text-white" style="background-color: #1e90ff;">
          <i class="fas fa-edit me-2"></i>
          Nouvelle Réservation
        </div>
        <div class="card-body">
          {% if error %}
            <div class="alert alert-danger">{{ error }}</div>
          {% endif %}
          {% if messages %}
            {% for message in messages %}
              {% if message.tags != 'success' %}
                <div class="alert alert-danger">{{ message }}</div>
              {% endif %}
            {% endfor %}
          {% endif %}
          
          <form method="post">
            {% csrf_token %}
            <div class="row g-3">
              <div class="col-12 col-sm-6 col-md-4">
                <label class="form-label">Patient :</label>
                <select name="patient" class="form-select" title="Choisir un patient" required>
                  <option value="">Choisir un patient</option>
                  {% for patient in patients %}
                    <option value="{{ patient.id }}">{{ patient }}</option>
                  {% endfor %}
                </select>
                {% if form.patient.errors %}
                  <div class="text-danger">{{ form.patient.errors.0 }}</div>
                {% endif %}
              </div>
              <div class="col-12 col-sm-6 col-md-4">
                <label class="form-label">Chambre :</label>
                <select name="room" class="form-select" title="Choisir une chambre" required>
                  <option value="">Choisir une chambre</option>
                  {% for room in rooms %}
                    <option value="{{ room.id }}">{{ room.room_name }}</option>
                  {% endfor %}
                </select>
                {% if form.room.errors %}
                  <div class="text-danger">{{ form.room.errors.0 }}</div>
                {% endif %}
              </div>
              <div class="col-12 col-sm-6 col-md-4">
                <label class="form-label">Lit :</label>
<select name="bed" class="form-select" title="Choisir un lit">
  <option value="">Non assigné</option>
  {% for bed in beds %}
    <option value="{{ bed.id }}">{{ bed.bed_number }}</option>
  {% endfor %}
</select>
                {% if form.bed.errors %}
                  <div class="text-danger">{{ form.bed.errors.0 }}</div>
                {% endif %}
              </div>
              <div class="col-12 col-sm-6 col-md-4">
                <label class="form-label">Date de début :</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="fas fa-calendar"></i></span>
                  <input type="date" name="start_date" class="form-control" required>
                </div>
                {% if form.start_date.errors %}
                  <div class="text-danger">{{ form.start_date.errors.0 }}</div>
                {% endif %}
              </div>
              <div class="col-12 col-sm-6 col-md-4">
                <label class="form-label">Date de fin :</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="fas fa-calendar"></i></span>
                  <input type="date" name="end_date" class="form-control" required>
                </div>
                {% if form.end_date.errors %}
                  <div class="text-danger">{{ form.end_date.errors.0 }}</div>
                {% endif %}
              </div>
              <div class="col-12 col-sm-6 col-md-4">
                <label class="form-label">Statut :</label>
                <select name="reservation_status" class="form-select" title="Choisir un statut" required>
                  <option value="">Choisir un statut</option>
                  {% for status in reservation_statuses %}
                    <option value="{{ status.0 }}">{{ status.1 }}</option>
                  {% endfor %}
                </select>
                {% if form.reservation_status.errors %}
                  <div class="text-danger">{{ form.reservation_status.errors.0 }}</div>
                {% endif %}
              </div>
            </div>
            <div class="d-flex flex-wrap gap-2 justify-content-end mt-4">
              <button type="button" class="btn btn-secondary btn-sm" data-bs-toggle="collapse" data-bs-target="#newReservationForm">
                <i class="fas fa-times"></i>
                <span class="d-none d-sm-inline ms-1">Annuler</span>
              </button>
              <button type="submit" class="btn btn-primary btn-sm">
                <i class="fas fa-save"></i>
                <span class="d-none d-sm-inline ms-1">Sauvegarder</span>
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
    </div>  
    </div>  
    <!-- Modal de détails de réservation -->
    <div class="modal fade" id="reservationDetailsModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Détails de la Réservation</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="row mb-3">
              <div class="col-md-6">
                <div class="card">
                  <div class="card-header text-white" style="background-color: #1e90ff;">
                    <h5 class="card-title mb-0">Informations sur le patient</h5>
                  </div>
                  <div class="card-body">
                    <p><strong>Nom:</strong> <span id="patientName"></span></p>
                    <p><strong>Chambre:</strong> <span id="roomName"></span></p>
                    <p><strong>Lit:</strong> <span id="bedNumber"></span></p>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="card">
                  <div class="card-header bg-info text-white">
                    <h5 class="card-title mb-0">Informations sur la réservation</h5>
                  </div>
                  <div class="card-body">
                    <p><strong>Période:</strong> <span id="reservationPeriod"></span></p>
                    <p><strong>Statut:</strong> <span id="reservationStatus" class="badge"></span></p>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
          </div>
        </div>
      </div>
    </div>

{% endblock %}
{% block extra_scripts %}
<link rel="stylesheet" href="{% static 'vendor/fullcalendar-5.11.3/lib/main.min.css' %}">
<script src="{% static 'vendor/js/bootstrap.bundle.min.js' %}"></script> 
<script src="{% static 'vendor/fullcalendar-5.11.3/lib/main.min.js' %}"></script> 
<script src="{% static 'vendor/js/sweetalert2@11.js' %}"></script> 
<script>
  document.addEventListener('DOMContentLoaded', function() {
  var calendarEl = document.getElementById('calendar');
  if (!calendarEl) {
    console.error('Calendar element not found');
    return;
  }
  
  var calendar = new FullCalendar.Calendar(calendarEl, {
    initialView: window.innerWidth < 768 ? 'dayGridWeek' : 'dayGridMonth',
    locale: 'fr',
    firstDay: 1,
    headerToolbar: {
      left: 'prev,next today',
      center: 'title',
      right: 'dayGridMonth,dayGridWeek'
    },
    buttonText: {
      today: "Aujourd'hui",
      month: 'Mois',
      week: 'Semaine'
    },
    dayHeaderFormat: { weekday: 'short' },
    events: function(info, successCallback, failureCallback) {
      fetch('/hosting/reservations/get_calendar_events/', {
        method: 'GET',
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        }
      })
      .then(response => {
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
      })
      .then(data => {
        const events = [];
        const reservationsByDate = {};
        
        // Group reservations by date
        if (data.reservations) {
          data.reservations.forEach(reservation => {
            let start = new Date(reservation.start_date);
            let end = new Date(reservation.end_date);
            end.setDate(end.getDate() + 1);
            
            let currentDate = new Date(start);
            while (currentDate < end) {
              const dateStr = currentDate.toISOString().split('T')[0];
              
              if (!reservationsByDate[dateStr]) {
                reservationsByDate[dateStr] = new Set();
              }
              
              reservationsByDate[dateStr].add(reservation.patient_name);
              
              currentDate.setDate(currentDate.getDate() + 1);
            }
          });
        }
        
        // Create an event per date
        for (const [dateStr, patients] of Object.entries(reservationsByDate)) {
          events.push({
            title: '•',
            start: dateStr,
            allDay: true,
            className: 'reservation-dot',
            extendedProps: {
              patients: Array.from(patients)
            }
          });
        }
        
        successCallback(events);
      })
      .catch(error => {
        console.error('Error fetching events:', error);
        failureCallback(error);
      });
    },
    eventContent: function(arg) {
      const dot = document.createElement('div');
      dot.className = 'reservation-dot';
      
      const patients = arg.event.extendedProps.patients;
      dot.title = `${patients.length} réservation(s)`;
      
      return { domNodes: [dot] };
    },
    eventClick: function(info) {
      if (info.event.classNames.includes('reservation-dot')) {
        const patients = info.event.extendedProps.patients;
        let html = '<div style="max-height: 300px; overflow-y: auto;">';
        
        patients.forEach(patientName => {
          html += `<p class="mb-1">${patientName}</p>`;
        });
        
        html += '</div>';
        
        Swal.fire({
          title: `${patients.length} réservation(s) le ${info.event.start.toLocaleDateString('fr-FR')}`,
          html: html,
          icon: 'info',
          confirmButtonText: 'Fermer',
          customClass: {
            confirmButton: 'btn btn-primary'
          }
        });
      }
    },
    datesSet: function(info) {
      var today = new Date();
      calendar.getEvents().forEach(function(event) {
        if (event.start.toDateString() === today.toDateString()) {
          event.setProp('backgroundColor', '#ffc107');
          event.setProp('borderColor', '#ffc107');
        }
      });
    }
  });
  
  calendar.render();

  // Table search and filter
  var searchInput = document.getElementById('searchReservationHistory');
  var statusFilter = document.getElementById('historyStatusFilter');
  var tableRows = document.querySelectorAll('#reservationHistoryTable tbody tr');

  function filterTable() {
    var searchText = searchInput.value.toLowerCase();
    var statusValue = statusFilter.value;

    tableRows.forEach(function(row) {
      var patient = row.cells[1].textContent.toLowerCase();
      var room = row.cells[2].textContent.toLowerCase();
      var bed = row.cells[3].textContent.toLowerCase();
      var status = row.cells[6].textContent.toLowerCase();
      
      var matchesSearch = patient.includes(searchText) || room.includes(searchText) || bed.includes(searchText);
      var matchesStatus = statusValue === '' || status.includes(statusValue.toLowerCase());

      row.style.display = matchesSearch && matchesStatus ? '' : 'none';
    });
  }

  searchInput.addEventListener('input', filterTable);
  statusFilter.addEventListener('change', filterTable);

  // Table sorting
  document.querySelectorAll('#reservationHistoryTable .sortable').forEach(function(header) {
    header.addEventListener('click', function() {
      var sortKey = parseInt(this.getAttribute('data-sortable'));
      var isAsc = !this.classList.contains('asc');
      
      document.querySelectorAll('#reservationHistoryTable .sortable').forEach(function(h) {
        h.classList.remove('asc', 'desc');
      });
      this.classList.add(isAsc ? 'asc' : 'desc');

      var rows = Array.from(tableRows);
      rows.sort(function(a, b) {
        var aValue = a.cells[sortKey].textContent.toLowerCase();
        var bValue = b.cells[sortKey].textContent.toLowerCase();
        return isAsc ? aValue.localeCompare(bValue) : bValue.localeCompare(aValue);
      });

      var tbody = document.querySelector('#reservationHistoryTable tbody');
      rows.forEach(function(row) {
        tbody.appendChild(row);
      });
    });
  });

  // View details button
  var reservationsData = [
    {% for reservation in reservations %}
      {
        id: {{ reservation.reservation_id }},
        patient: '{{ reservation.patient|escapejs }}',
        room: '{{ reservation.room.room_name|escapejs }}',
        bed: '{{ reservation.bed.bed_number|default:"Non assigné"|escapejs }}',
        start_date: '{{ reservation.start_date|date:"d/m/Y"|escapejs }}',
        end_date: '{{ reservation.end_date|date:"d/m/Y"|escapejs }}',
        status: '{{ reservation.get_reservation_status_display|escapejs }}'
      }{% if not forloop.last %},{% endif %}
    {% endfor %}
  ];

  document.querySelectorAll('.viewReservationDetails').forEach(function(button) {
    button.addEventListener('click', function() {
      var reservationId = this.getAttribute('data-id');
      var reservation = reservationsData.find(function(r) {
        return r.id == reservationId;
      });

      if (!reservation) {
        console.error('Reservation not found for ID:', reservationId);
        return;
      }

      document.getElementById('patientName').textContent = reservation.patient;
      document.getElementById('roomName').textContent = reservation.room;
      document.getElementById('bedNumber').textContent = reservation.bed;
      document.getElementById('reservationPeriod').textContent = reservation.start_date + ' - ' + reservation.end_date;
      document.getElementById('reservationStatus').textContent = reservation.status;
      document.getElementById('reservationStatus').className = 'badge ' + (
        reservation.status === 'Confirmed' ? 'bg-success' :
        reservation.status === 'Pending' ? 'bg-info' : 'bg-danger'
      );

      var modal = new bootstrap.Modal(document.getElementById('reservationDetailsModal'));
      modal.show();
    });
  });

  // Select all checkbox
  document.getElementById('selectAllHistory').addEventListener('change', function() {
    document.querySelectorAll('.row-check').forEach(function(checkbox) {
      checkbox.checked = this.checked;
    });
  });

  // Function to update export/import button
  const exportImportBtn = document.getElementById('export-import-btn');
  const exportImportIcon = document.getElementById('export-import-icon');
  const exportImportText = document.getElementById('export-import-text');
  
  function updateExportImportButton() {
    const checkedBoxes = document.querySelectorAll('.row-check:checked');
    const hasCheckedItems = checkedBoxes.length > 0;
    
    if (hasCheckedItems) {
      exportImportIcon.className = 'fas fa-file-export';
      exportImportText.textContent = 'Exporter';
    } else {
      exportImportIcon.className = 'fas fa-file-import';
      exportImportText.textContent = 'Importer';
    }
  }
  
  // Event listener for select all
  document.getElementById('selectAllHistory').addEventListener('change', updateExportImportButton);
  
  // Event listeners for row checkboxes
  document.addEventListener('change', function(e) {
    if (e.target.classList.contains('row-check')) {
      updateExportImportButton();
    }
  });
  
  // Initial update
  updateExportImportButton();
});
</script>
<style>
/* Styles pour le calendrier */
.calendar-container {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    padding: 20px;
    margin-top: 20px;
    width: 100%; 
}

/* Légende */
.legend {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin-bottom: 20px;
    padding: 15px;
    background-color: #f8f9fa;
    border-radius: 8px;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.9rem;
}

.legend-color {
    width: 16px;
    height: 16px;
    border-radius: 4px;
    border: 1px solid rgba(0,0,0,0.1);
}

/* Événements du calendrier */
.fc-event.reservation-event {
    border-radius: 4px !important;
    font-size: 0.8rem !important;
    padding: 2px 4px !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
}

.fc-event.reservation-event:hover {
    transform: scale(1.05) !important;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2) !important;
}

/* Mise en évidence d'aujourd'hui */
.fc-today-highlight {
    background-color: rgba(255, 193, 7, 0.1) !important;
    border: 2px solid #ffc107 !important;
}

/* Responsive */
@media (max-width: 768px) {
    .legend {
        flex-direction: column;
        gap: 10px;
    }
    
    .legend-item {
        font-size: 0.8rem;
    }
    
    .calendar-container {
        padding: 10px;
    }
}

/* Points de réservation (si vous voulez utiliser des points au lieu de texte) */
.reservation-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background-color: #28a745;
    margin: 2px auto;
    cursor: pointer;
    transition: all 0.2s ease;
}

.reservation-dot:hover {
    transform: scale(1.5);
    box-shadow: 0 0 5px rgba(40, 167, 69, 0.5);
}

/* Amélioration de l'affichage du calendrier FullCalendar */
.fc-toolbar {
    margin-bottom: 1rem !important;
}

.fc-toolbar-title {
    font-size: 1.5rem !important;
    font-weight: 600 !important;
    color: #2c3e50 !important;
}

.fc-button {
    background-color: #1e90ff !important;
    border-color: #1e90ff !important;
}

.fc-button:hover {
    background-color: #0d7bdb !important;
    border-color: #0d7bdb !important;
}

.fc-button:focus {
    box-shadow: 0 0 0 0.2rem rgba(30, 144, 255, 0.25) !important;
}

/* Jours avec réservations */
.fc-daygrid-day.has-reservations {
    background-color: rgba(40, 167, 69, 0.1);
}

/* Amélioration des cellules du calendrier */
.fc-daygrid-day:hover {
    background-color: rgba(30, 144, 255, 0.05);
    cursor: pointer;
}

/* Calendrier - Nouvelle règle pour forcer la largeur à 100% */
#calendar {
    width: 100%;
}
</style>
{% endblock %}