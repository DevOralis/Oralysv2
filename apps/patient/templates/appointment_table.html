
<div class="table-responsive">
    <table class="table table-striped table-hover" id="tableAppointments">
        <thead>
            <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                <th class="d-none d-md-table-cell">
                    <input type="checkbox" id="selectAllAppointments">
                </th>
                <th>
                    <div class="d-flex align-items-center">
                        <span>Date/Heure</span>
                        <i class="fas fa-sort sort-icon ms-1 text-white-50"></i>
                    </div>
                </th>
                <th>
                    <div class="d-flex align-items-center">
                        <span>Patient</span>
                        <i class="fas fa-sort sort-icon ms-1 text-white-50"></i>
                    </div>
                </th>
                <th class="d-none d-lg-table-cell">
                    <div class="d-flex align-items-center">
                        <span>Médecin</span>
                        <i class="fas fa-sort sort-icon ms-1 text-white-50"></i>
                    </div>
                </th>
                <th class="d-none d-lg-table-cell">
                    <div class="d-flex align-items-center">
                        <span>Motif</span>
                        <i class="fas fa-sort sort-icon ms-1 text-white-50"></i>
                    </div>
                </th>
                <th>
                    <div class="d-flex align-items-center">
                        <span>Statut</span>
                        <i class="fas fa-sort sort-icon ms-1 text-white-50"></i>
                    </div>
                </th>
                <th class="text-center d-lg-none">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for appointment in appointments %}
            <tr>
                <td data-label="Sélection" class="d-none d-md-table-cell">
                    <input type="checkbox" class="row-check" 
                           data-id="{{ appointment.id }}"
                           data-date="{{ appointment.date_heure|date:'d/m/Y H:i' }}"
                           data-patient="{% if appointment.patient %}{{ appointment.patient.last_name }} {{ appointment.patient.first_name }}{% else %}{{ appointment.nom }} {{ appointment.prenom }}{% endif %}"
                           data-medecin="{{ appointment.medecin.full_name }}"
                           data-motif="{{ appointment.motif }}"
                           data-statut="{{ appointment.statut }}">
                </td>
                <td data-label="Date/Heure">{{ appointment.date_heure|date:'d/m/Y H:i' }}</td>
                <td data-label="Patient">{% if appointment.patient %}{{ appointment.patient.last_name }} {{ appointment.patient.first_name }}{% else %}{{ appointment.nom }} {{ appointment.prenom }}{% endif %}</td>
                <td data-label="Médecin" class="d-none d-lg-table-cell">{{ appointment.medecin.full_name }}</td>
                <td data-label="Motif" class="d-none d-lg-table-cell">{{ appointment.motif }}</td>
                <td data-label="Statut">
                    {% if appointment.statut == 'à venir' %}
                        <span class="badge bg-primary">À venir</span>
                    {% elif appointment.statut == 'effectué' %}
                        <span class="badge bg-success">Effectué</span>
                    {% elif appointment.statut == 'annulé' %}
                        <span class="badge bg-danger">Annulé</span>
                    {% else %}
                        <span class="badge bg-secondary">{{ appointment.statut }}</span>
                    {% endif %}
                </td>
                <td data-label="Actions" class="text-center d-lg-none">
                    <button class="btn btn-sm btn-light border text-info voir-plus-btn" 
                            data-bs-toggle="modal" 
                            data-bs-target="#appointmentDetailsModal"
                            data-date="{{ appointment.date_heure|date:'d/m/Y H:i' }}"
                            data-patient="{% if appointment.patient %}{{ appointment.patient.last_name }} {{ appointment.patient.first_name }}{% else %}{{ appointment.nom }} {{ appointment.prenom }}{% endif %}"
                            data-medecin="{{ appointment.medecin.full_name }}"
                            data-motif="{{ appointment.motif }}"
                            data-statut="{{ appointment.statut }}"
                            title="Voir plus">
                        <i class="fas fa-eye"></i>
                    </button>
                </td>
            </tr>
            {% empty %}
            <tr id="appointments-no-results"><td colspan="7" class="text-center">Aucun rendez-vous</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Pagination JavaScript (2 rendez-vous par page) -->

{% with search_param=search_rdv|default_if_none:'' medecin_param=filter_rdv_medecin|default_if_none:'' statut_param=filter_rdv_statut|default_if_none:'' %}
<!-- Pagination -->
{% if paginator.num_pages > 1 %}
<nav aria-label="Pagination des rendez-vous">
  <ul class="pagination justify-content-center">
    {% if appointments.has_previous %}
      <li class="page-item">
        <a class="page-link page-ajax" href="?page={{ appointments.previous_page_number }}{% if search_param %}&search_rdv={{ search_param }}{% endif %}{% if medecin_param %}&filter_rdv_medecin={{ medecin_param }}{% endif %}{% if statut_param %}&filter_rdv_statut={{ statut_param }}{% endif %}" aria-label="Précédent"><span aria-hidden="true">&laquo;</span></a>
      </li>
    {% else %}
      <li class="page-item disabled"><span class="page-link"><span aria-hidden="true">&laquo;</span></span></li>
    {% endif %}
    {% for num in paginator.page_range %}
      {% if num == appointments.number %}
        <li class="page-item active"><span class="page-link">{{ num }}</span></li>
      {% else %}
        <li class="page-item">
          <a class="page-link page-ajax" href="?page={{ num }}{% if search_param %}&search_rdv={{ search_param }}{% endif %}{% if medecin_param %}&filter_rdv_medecin={{ medecin_param }}{% endif %}{% if statut_param %}&filter_rdv_statut={{ statut_param }}{% endif %}">{{ num }}</a>
        </li>
      {% endif %}
    {% endfor %}
    {% if appointments.has_next %}
      <li class="page-item">
        <a class="page-link page-ajax" href="?page={{ appointments.next_page_number }}{% if search_param %}&search_rdv={{ search_param }}{% endif %}{% if medecin_param %}&filter_rdv_medecin={{ medecin_param }}{% endif %}{% if statut_param %}&filter_rdv_statut={{ statut_param }}{% endif %}" aria-label="Suivant"><span aria-hidden="true">&raquo;</span></a>
      </li>
    {% else %}
      <li class="page-item disabled"><span class="page-link"><span aria-hidden="true">&raquo;</span></span></li>
    {% endif %}
  </ul>
</nav>
{% endif %}
{% endwith %}